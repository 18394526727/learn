<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>测试rtmp直播源</title>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/5.5.3/video-js.min.css" rel="stylesheet">
	<script src="https://cdn.bootcss.com/jquery/1.12.0/jquery.min.js"></script>
	<style>
		.video-area {
			border: 4px solid red;
			display: inline-block;
		}
	</style>
</head>
<body>
<div class="video-area">

	<div class="openFlashTips" style="width:300px;position:absolute;top:20px;left:225px;z-Index:9999;color:white">
		视频无法正常播放，请点击下方启用flash
	</div>
	<video id="video-player" style="color:black;width:750px;height:350px" class="video-js" controls preload="auto"
		   width="750" height="350" data-setup="{}">
	</video>
	<embed width="300" height="70" class="openFlash" style="position:absolute;top:130px;left:225px;z-Index:9999;"
		   type="application/x-shockwave-flash">
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/5.5.3/video.min.js"></script>
<script type="text/javascript" language="JavaScript">

    /*-------初始化播放器------------------------------------------------------------------------------------------------*/
    let fls = flashChecker();
    if (fls.f) {
        $(".openFlash,.openFlashTips").hide()
    } else {
        $(".openFlash,.openFlashTips").show()
    }
    let myPlayer = videojs('video-player');
    myPlayer.src({type: 'rtmp/flv', src: 'rtmp://media3.sinovision.net:1935/live/livestream'});
    myPlayer.ready(function () {
        myPlayer.play();
        let tech = myPlayer.tech({IWillNotUseThisInPlugins: true});
        myPlayer.on("pause", function () {
            myPlayer.on("play", function () {
                myPlayer.load();
                myPlayer.off("play");
            });
        });
    });
    /*-----公共方法--------------------------------------------------------------------------------------------------------------*/
    /*-----检测是否安装/启用了flash-------------------------------------------------------------------------------------------------------------*/
    function flashChecker() {
        let hasFlash = 0;         //是否安装了flash
        let flashVersion = 0; //flash版本
        let isIE = 0;      //是否IE浏览器
        if (isIE) {
            let swf = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');
            if (swf) {
                hasFlash = 1;
                VSwf = swf.GetVariable("$version");
                flashVersion = parseInt(VSwf.split(" ")[1].split(",")[0]);
            }
        } else {
            if (navigator.plugins && navigator.plugins.length > 0) {
                let swf = navigator.plugins["Shockwave Flash"];
                if (swf) {
                    hasFlash = 1;
                    let words = swf.description.split(" ");
                    for (let i = 0; i < words.length; ++i) {
                        if (isNaN(parseInt(words[i]))) continue;
                        flashVersion = parseInt(words[i]);
                    }
                }
            }
        }
        return {f: hasFlash, v: flashVersion};
    }

</script>
</body>
</html>
